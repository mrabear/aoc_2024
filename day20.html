<!DOCTYPE html>
<html>
	<!-- Brian's Advent of Code Solution Template -->

	<!-- stealing the advent of code style -->
	<head>
		<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro:300&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" type="text/css" href="https://adventofcode.com/static/style.css?16"/>
		<link rel="stylesheet alternate" type="text/css" href="https://adventofcode.com/static/highcontrast.css?0" title="High Contrast"/>
	</head>

	<body style="font-family: 'Source Code Pro', monospace; font-size: 14pt; min-width: 0px;">

      	<script type="text/javascript">

		const WALL_ICON = "#";
		const EMPTY_ICON = ".";
		const START_ICON = "S";
		const END_ICON = "E";
		const CHEAT_START = "@";
		const CHEAT_END = ">";
		const UNSET = -1;
		const NORTH = "N";
		const SOUTH = "S";
		const EAST = "E";
		const WEST = "W";
		const MOVE_OPTIONS = [
			new Move(  0,  1, SOUTH ),
			new Move(  1,  0, EAST ),
			new Move(  0, -1, NORTH ),
			new Move( -1,  0, WEST )
		];
		const BLOCKS_TO_READ = 1024;
		const DEBUG_LOGGING = true;
		const CHEAT_DISTANCE = 20;

		var radiusMask = [];
		var walls = [];
		var queue = [];
		var grid = [];
		var shortestPath = [];
		var shortestPathString;
		var validCheats = [];
 		var gridXLength;
 		var gridYLength;
 		var currentCheat;
 		var part2total = 0;
 		var solutions = {};
 		var currentAnchor;
 		var checkValue = 68;
		var mazeStart;
		var mazeEnd;
		var cache = {};
		var lowScore = UNSET;

      	function Point( x, y ){
      		this.x = x;
      		this.y = y;
	      	this.toString = function(){ return( `(${this.x},${this.y})` ) };
	      	this.equals = function( x, y ){ return(( this.x == x && this.y == y )?true:false )};
      	};

      	function Move( xdif, ydif, dir ){
      		this.xdif = xdif;
      		this.ydif = ydif;
      		this.dir = dir;
	      	this.toString = function(){ return( `${dir}` ) };
      	}

      	function Cheat( startx, starty, endx, endy, baseline ){
      		this.start = new Point( startx, starty );
      		this.end = new Point( endx, endy );
      		this.baseline = +baseline;
	      	this.toString = function(){ return( `(${this.start.x},${this.start.y})=>(${this.end.x},${this.end.y})` ) };
      	}
      	// 5806 - high
      	// 128 - low
		// Solve that shit
      	function solveThatShit(){
      		var startTime = new Date();
      		var input = new Array();
			var debug = document.getElementById("debug");
			input = document.getElementById("input").value.split("\n");

			for( let i = 0 ; i < input.length ; i++ ){
				grid[i] = input[i].split( "" );
				let lookup = input[i].indexOf( START_ICON );
				if( lookup >= 0 )
					mazeStart = new Point( lookup, i );
				lookup = input[i].indexOf( END_ICON );
				if( lookup >= 0 )
					mazeEnd = new Point( lookup, i );
			}

			gridXLength = grid[0].length;
			gridYLength = grid.length;

			console.log( `Grid Size (${gridXLength},${gridYLength}) Loaded Start(${mazeStart.x},${mazeStart.y}) End(${mazeEnd.x},${mazeEnd.y}))\n ==============================\n` );
			
			// INSERT SOLUTION HERE
			cache = {};
			addToQueue( mazeStart.x, mazeStart.y, UNSET, 0, "" );
			while( queue.length > 0 ){
				makeMove();
			}

			shortestPath.push( mazeStart );

			for( let coord of shortestPathString.split( "#" ) ){
				let[ x, y ] = coord.split( "," );
				if( x != 0 )
					shortestPath.push( new Point( +x, +y ) ); 
			}

			debugLog( `shortest path: ${shortestPath}` );

			cache = {};
			var counter = 0;
			for( let coord of shortestPath ){
				setSafeGridValue( coord.x, coord.y, counter );
				//setSafeGridValue( coord.x, coord.y, PLAYER_ICON );
				for( let move of MOVE_OPTIONS ){
					let startX = coord.x + move.xdif;
					let startY = coord.y + move.ydif;
					let endX = startX + move.xdif;
					let endY = startY + move.ydif;

					//debugLog( `Testing from (${coord.x},${coord.y}): (${startX},${startY})->(${endX},${endY}) Move=(${move.xdif}|${move.ydif})` );

					if( ( getSafeGridValue( startX, startY ) == WALL_ICON ) &&
						( getSafeGridValue( endX, endY ) == EMPTY_ICON || 
					      getSafeGridValue( endX, endY ) == START_ICON ||
					      getSafeGridValue( endX, endY ) == END_ICON ) &&
						( inBounds( startX, startY ) && inBounds( endX, endY ) ) &&
						( !(cache[ `${startX},${startY}` ])) ){
						//debugLog( `valid cheat found (${startX},${startY})->(${endX},${endY})` );
						cache[ `${startX},${startY}` ] = true;
						validCheats.push( new Cheat( startX, startY, endX, endY, UNSET ) );
					}
				}
				counter++;
			}



			// part 1
			var part1total = 0;
			var baselineScore = lowScore;
			for( let cheat of validCheats ){
				var endvalue = getSafeGridValue( cheat.end.x, cheat.end.y );
				var startvalue = getSafeGridValue( cheat.start.x - (cheat.end.x-cheat.start.x), cheat.start.y - (cheat.end.y - cheat.start.y) );
				var newScore = baselineScore - ( endvalue - startvalue - 2);

				if( ( baselineScore - newScore >= 100) ){
					part1total++;
					//console.log( `finished cheat ${cheat} scored ${newScore} with baseline ${baselineScore} - COUNTS! ${startvalue}/${endvalue}` );
				} else {
					//console.log( `finished cheat ${cheat} scored ${newScore} with baseline ${baselineScore} ${startvalue}/${endvalue}` );
				}
			}

			// rebuild cheats for step 2
			cache = {};
			validCheats = [];

			var counter = 0;
			for( let coord of shortestPath ){
				setSafeGridValue( coord.x, coord.y, counter );
				//setSafeGridValue( coord.x, coord.y, PLAYER_ICON );
				if( !(mazeEnd.equals( coord.x, coord.y ) ) ){
					for( let move of MOVE_OPTIONS ){
						let startX = coord.x + move.xdif;
						let startY = coord.y + move.ydif;
						let endX = startX + move.xdif;
						let endY = startY + move.ydif;

						if( ( getSafeGridValue( startX, startY ) == WALL_ICON ) &&
							( inBoundsStrict( startX, startY ) ) ){// &&
							//( !(cache[ `${startX},${startY}` ]) ) )  { 
							//debugLog( `valid cheat found (${startX},${startY})->(${endX},${endY})` );
							//cache[ `${startX},${startY}` ] = true;
							validCheats.push( new Cheat( startX, startY, endX, endY, getSafeGridValue( coord.x, coord.y ) ) );
						}
					}
					counter++;
				}
			}

			//console.log( `${validCheats.length} cheats are calcualted: ${validCheats}` );

			/*for( let cheat of validCheats ){
				setSafeGridValue( cheat.start.x, cheat.start.y, CHEAT_START );
			}*/

			//printGridWithValues();

			console.log( `starting part 2 analysis with baseline score ${lowScore}` );
			/*for( let cheat of validCheats ){
				cache = {};
				//solutions = {};
				console.log( `##### starting cheat ${cheat} current score ${part2total} #####` );
				checkValidCheats( cheat.start.x, cheat.start.y, cheat, 0 );
			}*/

			// low 11087
			// low 11088
			// low 953486
			//	   957831

			checkValue = 100;
			for( let coord of shortestPath ){
				for( let y = CHEAT_DISTANCE * -1 - 10 ; y <= CHEAT_DISTANCE + 10 ; y++ ){
					for( let x = CHEAT_DISTANCE * -1 - 10; x <= CHEAT_DISTANCE+ 10 ; x++ ){
						let newX = coord.x + x;
						let newY = coord.y + y;

						if( inBoundsStrict( newX, newY ) && 
							getDistance( coord.x, coord.y, newX, newY ) <= CHEAT_DISTANCE &&
							!isNaN( getSafeGridValue( newX, newY ) ) ){

							let endvalue = getSafeGridValue( newX, newY );
							let newScore = ( lowScore - endvalue ) + ( getSafeGridValue( coord.x, coord.y ) + getDistance( newX, newY, coord.x, coord.y ) ) ;
							let scoreReduction = lowScore - newScore;

							if( scoreReduction >= checkValue )
								part2total++;
						}
					}
				}
			}

			//printGrid();

			document.getElementById("part1").value = part1total;
			document.getElementById("part2").value = part2total;

			console.log( "\n==============================\nRun Completed in " +  ((new Date() - startTime) / 1000 ).toFixed(2)  + " seconds\n" );
		}

		function getDistance( x1, y1, x2, y2 ){
			return( Math.abs(x1 - x2) + Math.abs(y1 - y2) );
		}

		function checkValidCheats( x, y, cheat, depth ){
			checkValue = 66;
			if( !( `${x},${y}` in cache ) ){
				var endvalue = getSafeGridValue( x, y );
				var newScore = ( lowScore - endvalue ) + ( cheat.baseline + getDistance( x, y, cheat.start.x, cheat.start.y ) + 1 ) ;
				var scoreReduction = lowScore - newScore;

				if( !( isNaN( getSafeGridValue( x, y )  ) ) ){
					if( inBoundsStrict( x, y ) ){

						//console.log( `end(${endvalue}) end(${newScore})`);

						if( ( scoreReduction == checkValue ) ){
							let solX = cheat.start.x - (cheat.end.x-cheat.start.x);
							let solY = cheat.start.y - (cheat.end.y-cheat.start.y);
							if( !( `${solX},${solY}|${x},${y}` in solutions ) ){
									console.log( `(${x},${y}:${depth}): SUCCESS! cheat score(${lowScore - newScore}) cache(${solX},${solY}|${x},${y}) ${newScore} (${lowScore}-${endvalue})+(${cheat.baseline}+${Math.abs(x - cheat.start.x)}+${Math.abs(y - cheat.start.y)}+1)` );
									solutions[ `${solX},${solY}|${x},${y}` ] = scoreReduction;
									part2total++;
							} else {
								console.log( `(${x},${y}:${depth}): FAIL! already cached(${solX},${solY}|${x},${y}) ${newScore} (${lowScore}-${endvalue})+(${cheat.baseline}+${Math.abs(x - cheat.start.x)}+${Math.abs(y - cheat.start.y)}+1)` );
							}
						} 
					}
				} 

				if( inBoundsStrict( x, y ) ){
					//console.log( `(${x},${y}:${depth}): at a wall, iterating ${newScore} (${lowScore}-${endvalue})+(${cheat.baseline}+${Math.abs(x - cheat.start.x)}+${Math.abs(y - cheat.start.y)}+1)` );
					cache[ `${x},${y}` ] = true;
					for( let move of MOVE_OPTIONS ){
						if(  ( inBoundsStrict( x + move.xdif, y + move.ydif ) ) &&
						    !( cache[ `${x + move.xdif},${y + move.ydif}` ] )   &&
						     ( getDistance( cheat.start.x, cheat.start.y, x + move.xdif, y + move.ydif ) < CHEAT_DISTANCE - 1 ) ) { 
							//console.log( `(${x},${y}:${depth}): entering ${x + move.xdif},${y + move.ydif} ` );
							checkValidCheats( x + move.xdif, y + move.ydif, cheat, depth + 1 );
							//console.log( `(${x},${y}:${depth}): exiting ${x + move.xdif},${y + move.ydif} ` );
						} else {
							//console.log( `(${x},${y}:${depth}): failed check not iterating to ${x + move.xdif},${y + move.ydif} ` );
						}
					}
				}
			}
		}

		function makeMove(){
			var[ x, y, direction, score, movelist ] = getNextMove();

			//debugLog( `${score}:(${x},${y}): starting move` );

			if( mazeEnd.equals( x, y ) ){
				//debugLog( `${score}:(${x},${y}): ### maze end found with score ${score} ###` );
				if( isLowScore( score ) ){
					lowScore = score;
					shortestPathString = movelist;
				}
			} else if( isLowScore( score ) ) {
				for( var move of MOVE_OPTIONS ){
					//debugLog( `${score}:(${x},${y}): trying (${x + move.xdif},${y + move.ydif})` );

					if(!( isOppositeDirection( move.dir, direction )                      ) &&
						( getSafeGridValue( x + move.xdif, y + move.ydif ) != WALL_ICON   ) && 
						( inBounds( x + move.xdif, y + move.ydif )                        ) &&
					   !( getSafeGridValue( x, y ) == CHEAT_END &&
						  getSafeGridValue( x + move.xdif, y + move.ydif ) == CHEAT_START ) ){
						//debugLog( `${score}:(${x},${y}): adding (${x + move.xdif},${y + move.ydif}:${score+1}) to queue ###` );
						addToQueue( x + move.xdif, y + move.ydif, move.dir, score + 1, `${movelist}#${x + move.xdif},${y + move.ydif}` );
					}
				}
			}
		}

		function addToQueue( x, y, direction, score, movelist ){
			if( !(`${x},${y}` in cache) )
				cache[ `${x},${y}` ] = score;
			else if( score >= cache[ `${x},${y}` ] )
				return;

			queue.push( [ x, y, direction, score, movelist ] );
		}

		function getNextMove(){
			return( queue.shift() );
		}

		function isLowScore( score ){
			if( score <= lowScore || lowScore == UNSET )
				return( true );
			else
				return( false );
		}

		function isOppositeDirection( startDir, endDir ){
			if( ( startDir == NORTH && endDir == SOUTH ) ||
				( startDir == EAST  && endDir == WEST  ) ||
				( startDir == SOUTH && endDir == NORTH ) ||
				( startDir == WEST  && endDir == EAST  ) )
				return( true );
			else
				return( false );
		}

		function printGrid(){
			var buffer = "";
			for( var line of grid )
				buffer += line.join("") + "\n";
			console.log( buffer );
		}

		function printGridWithValues(){
			var buffer = "";
			for( var y = 0 ; y < gridYLength ; y++ ){
				for( var x = 0 ; x < gridXLength ; x++ ){
					//buffer += line.join("") + "\n";
					if( getSafeGridValue( x, y ) != WALL_ICON )
						buffer += "|" + grid[y][x].toString().padStart( 2, 0 );
					else
						buffer += "|__";
				}
				buffer += "|\n";
			}
			console.log( buffer );
		}

		function getSafeGridValue( x, y ){
			if( ( x >= 0 && x < gridXLength ) &&
				( y >= 0 && y < gridYLength ) )
				return( grid[y][x] );
			else
				return("");
		}

		function inBounds( x, y ){
			if( ( x >= 0 && x < gridXLength ) &&
				( y >= 0 && y < gridYLength ) )
				return( true );
			else
				return( false );
		}

		function inBoundsStrict( x, y ){
			if( ( x > 0 && x < gridXLength-1 ) &&
				( y > 0 && y < gridYLength-1 ) )
				return( true );
			else
				return( false );
		}

		function setSafeGridValue( x, y, value ){
			if( ( x >= 0 && x < gridXLength ) &&
				( y >= 0 && y < gridYLength ) ){
				grid[y][x] = value;
				return( true );
			} else {
				return( false );
			}
		}

		function debugLog( message ){
			if( DEBUG_LOGGING )
				console.log( message );
		}

		</script>
		<div align="center">

			<!-- UPDATE SUBMISSION DAY HERE -->
			<!-- Page Title -->
			<h1 style="color: #00cc00;">Advent of Code 2024: Day 20 Submission ( <a href="https://adventofcode.com/2024/day/20" target="_blank">Overview</a> | <a href="https://github.com/mrabear/aoc_2024" target="_blank">Github</a> )</h1>

			<!-- COPY/PASTE SOURCE INPUT HERE -->
			<!-- Input Box -->
			<font style="color: #00cc00;">Input:</font><br>
			<textarea id="input" cols="80" rows="10" style="font-size: 16px; border:solid 1px #00cc00;">#############################################################################################################################################
#...#...###.......#...#.....#...#.......#.........#.....###.....#...#...#.............#.......#.........#...###.........#...#.......#.....###
#.#.#.#.###.#####.#.#.#.###.#.#.#.#####.#.#######.#.###.###.###.#.#.#.#.#.###########.#.#####.#.#######.#.#.###.#######.#.#.#.#####.#.###.###
#.#...#...#.#.....#.#.#...#.#.#.#...#...#.....#...#...#...#...#.#.#...#.#.........#...#.#.....#...#.....#.#...#...#.....#.#.#...#...#...#...#
#.#######.#.#.#####.#.###.#.#.#.###.#.#######.#.#####.###.###.#.#.#####.#########.#.###.#.#######.#.#####.###.###.#.#####.#.###.#.#####.###.#
#.......#.#.#.#...#.#...#.#.#.#.....#.#...###.#.#...#.#...#...#...#...#.#.........#.....#...#...#.#...###.#...#...#.#...#.#...#.#.#...#.#...#
#######.#.#.#.#.#.#.###.#.#.#.#######.#.#.###.#.#.#.#.#.###.#######.#.#.#.#################.#.#.#.###.###.#.###.###.#.#.#.###.#.#.#.#.#.#.###
###.....#...#...#.#...#.#.#.#.....#...#.#.....#.#.#.#.#...#.#...#...#...#...............#...#.#.#.#...#...#...#.#...#.#.#.#...#.#.#.#.#.#.###
###.#############.###.#.#.#.#####.#.###.#######.#.#.#.###.#.#.#.#.#####################.#.###.#.#.#.###.#####.#.#.###.#.#.#.###.#.#.#.#.#.###
#...#.......#.....###.#.#.#.###...#...#.......#.#.#.#.#...#.#.#...#...###.......###.....#.###.#...#.....#.....#.#...#.#.#.#...#.#.#.#.#.#...#
#.###.#####.#.#######.#.#.#.###.#####.#######.#.#.#.#.#.###.#.#####.#.###.#####.###.#####.###.###########.#####.###.#.#.#.###.#.#.#.#.#.###.#
#.....#.....#...###...#...#.....#.....###.....#.#.#.#.#.#...#.....#.#...#.....#.#...#...#.#...#.....#...#.#...#.#...#.#.#.#...#.#.#.#.#.#...#
#######.#######.###.#############.#######.#####.#.#.#.#.#.#######.#.###.#####.#.#.###.#.#.#.###.###.#.#.#.#.#.#.#.###.#.#.#.###.#.#.#.#.#.###
#...###.......#...#.............#...#...#...#...#.#.#.#.#.#.......#.#...#...#.#.#.....#.#.#...#...#.#.#...#.#.#.#...#.#.#.#.....#...#...#...#
#.#.#########.###.#############.###.#.#.###.#.###.#.#.#.#.#.#######.#.###.#.#.#.#######.#.###.###.#.#.#####.#.#.###.#.#.#.#################.#
#.#.#.......#.#...#...###...#...#...#.#.....#...#.#.#.#...#...#...#.#.#...#...#...#.....#.#...#...#...#...#.#...#...#.#...#...#.........#...#
#.#.#.#####.#.#.###.#.###.#.#.###.###.#########.#.#.#.#######.#.#.#.#.#.#########.#.#####.#.###.#######.#.#.#####.###.#####.#.#.#######.#.###
#.#.#.....#...#.....#.#...#...#...###.......#...#.#.#.#.....#.#.#.#.#.#.......#...#.....#...#...#.....#.#.#.....#.#...#.....#...###...#.#...#
#.#.#####.###########.#.#######.###########.#.###.#.#.#.###.#.#.#.#.#.#######.#.#######.#####.###.###.#.#.#####.#.#.###.###########.#.#.###.#
#.#.....#.......#...#.#.......#.#...#...#...#...#.#...#...#...#.#.#.#.#.......#.....#...#...#.....#...#.#.......#...#...#.......#...#.#.....#
#.#####.#######.#.#.#.#######.#.#.#.#.#.#.#####.#.#######.#####.#.#.#.#.###########.#.###.#.#######.###.#############.###.#####.#.###.#######
#.....#.###...#.#.#...#...#...#.#.#...#.#.#...#...#.......#...#.#...#.#.....#.......#...#.#.#...#...###...#.....#.....###.#.....#.#...#.....#
#####.#.###.#.#.#.#####.#.#.###.#.#####.#.#.#.#####.#######.#.#.#####.#####.#.#########.#.#.#.#.#.#######.#.###.#.#######.#.#####.#.###.###.#
#.....#...#.#.#.#.#...#.#.#...#.#...#...#...#...#...###...#.#.#.....#.#.....#.....#...#.#.#...#...#.....#...#...#.........#.......#...#...#.#
#.#######.#.#.#.#.#.#.#.#.###.#.###.#.#########.#.#####.#.#.#.#####.#.#.#########.#.#.#.#.#########.###.#####.#######################.###.#.#
#.#.....#...#...#...#.#.#.....#...#.#...#...###.#.....#.#.#.#.###...#.#.........#...#.#.#.....#...#.#...#.....#...#...#...#...#.....#.#...#.#
#.#.###.#############.#.#########.#.###.#.#.###.#####.#.#.#.#.###.###.#########.#####.#.#####.#.#.#.#.###.#####.#.#.#.#.#.#.#.#.###.#.#.###.#
#...###...#.........#...#.......#.#.#...#.#.#...#.....#.#...#.#...#...#.......#.....#...#...#...#.#.#.#...#.....#.#.#...#.#.#...#...#.#.#...#
#########.#.#######.#####.#####.#.#.#.###.#.#.###.#####.#####.#.###.###.#####.#####.#####.#.#####.#.#.#.###.#####.#.#####.#.#####.###.#.#.###
#.........#.#.......#.....#.....#.#.#.###.#.#...#.....#.#.....#...#.###...#...#...#.....#.#.......#.#.#...#.....#.#.....#.#.....#...#...#...#
#.#########.#.#######.#####.#####.#.#.###.#.###.#####.#.#.#######.#.#####.#.###.#.#####.#.#########.#.###.#####.#.#####.#.#####.###.#######.#
#.....#.....#.........#...#.....#.#.#.#...#.#...#.....#.#...#...#.#.#...#.#.#...#.#.....#...#.....#.#...#.#.....#...#...#.#...#.#...#.....#.#
#####.#.###############.#.#####.#.#.#.#.###.#.###.#####.###.#.#.#.#.#.#.#.#.#.###.#.#######.#.###.#.###.#.#.#######.#.###.#.#.#.#.###.###.#.#
#.....#...#E............#.....#.#.#.#.#...#.#...#.#...#.#...#.#.#.#.#.#.#.#.#...#.#.....#...#...#.#...#.#.#.###...#...###...#...#...#...#.#.#
#.#######.###################.#.#.#.#.###.#.###.#.#.#.#.#.###.#.#.#.#.#.#.#.###.#.#####.#.#####.#.###.#.#.#.###.#.#################.###.#.#.#
#...#.....###################...#...#...#.#.#...#.#.#.#.#.....#.#.#.#.#...#.#...#...#...#.#...#.#...#.#...#.....#.........#...#...#.#...#.#.#
###.#.#################################.#.#.#.###.#.#.#.#######.#.#.#.#####.#.#####.#.###.#.#.#.###.#.###################.#.#.#.#.#.#.###.#.#
###...#...#...#########################.#.#.#...#...#.#.......#.#.#.#.#.....#...###.#...#.#.#.#.#...#.#.....#...#...#.....#.#.#.#.#...#...#.#
#######.#.#.#.#########################.#.#.###.#####.#######.#.#.#.#.#.#######.###.###.#.#.#.#.#.###.#.###.#.#.#.#.#.#####.#.#.#.#####.###.#
#.......#.#.#.#########################...#.#...#.....#...#...#...#.#.#...#...#...#.#...#.#.#...#...#.#...#...#...#...#.....#...#.....#.....#
#.#######.#.#.#############################.#.###.#####.#.#.#######.#.###.#.#.###.#.#.###.#.#######.#.###.#############.#############.#######
#.......#.#.#.#...#########################.#...#.....#.#.#.......#.#.#...#.#.#...#.#...#.#.#.......#.###...#.......#...#.............###...#
#######.#.#.#.#.#.#########################.###.#####.#.#.#######.#.#.#.###.#.#.###.###.#.#.#.#######.#####.#.#####.#.###.###############.#.#
#.......#.#.#.#.#...#######################.#...#.....#.#.#.....#.#.#.#...#.#...#...#...#.#.#.#.....#.#.....#.#.....#...#.#.............#.#.#
#.#######.#.#.#.###.#######################.#.###.#####.#.#.###.#.#.#.###.#.#####.###.###.#.#.#.###.#.#.#####.#.#######.#.#.###########.#.#.#
#.......#...#...#...#######################...###.....#.#...#...#.#.#.###.#.....#...#...#.#.#.#.###...#.......#.........#...#...........#.#.#
#######.#########.###################################.#.#####.###.#.#.###.#####.###.###.#.#.#.#.#############################.###########.#.#
#...###.........#.#######S###############.....#...#...#...#...#...#...#...#...#...#...#.#.#.#.#.#.......................#.....###...#...#.#.#
#.#.###########.#.#######.###############.###.#.#.#.#####.#.###.#######.###.#.###.###.#.#.#.#.#.#.#####################.#.#######.#.#.#.#.#.#
#.#.......#.....#.#######.#...#.........#.#...#.#...#.....#...#.....###...#.#.....###.#.#.#.#.#.#.....................#...#.....#.#...#.#.#.#
#.#######.#.#####.#######.#.#.#.#######.#.#.###.#####.#######.#####.#####.#.#########.#.#.#.#.#.#####################.#####.###.#.#####.#.#.#
#.#.....#.#.....#.#######.#.#.#.#.......#.#...#.#...#...###...#...#...#...#.......#...#.#.#.#...#...#.........#.......#...#...#...#.....#.#.#
#.#.###.#.#####.#.#######.#.#.#.#.#######.###.#.#.#.###.###.###.#.###.#.#########.#.###.#.#.#####.#.#.#######.#.#######.#.###.#####.#####.#.#
#.#.#...#.......#.....###...#.#.#.......#.#...#...#...#...#...#.#...#.#.#...#...#.#...#.#.#.###...#...#.....#.#...#.....#.....#...#.......#.#
#.#.#.###############.#######.#.#######.#.#.#########.###.###.#.###.#.#.#.#.#.#.#.###.#.#.#.###.#######.###.#.###.#.###########.#.#########.#
#...#...............#.#.....#...###...#.#.#.......#...#...#...#...#.#.#.#.#.#.#.#...#...#...#...#.......#...#.....#.#.......#...#.#.....#...#
###################.#.#.###.#######.#.#.#.#######.#.###.###.#####.#.#.#.#.#.#.#.###.#########.###.#######.#########.#.#####.#.###.#.###.#.###
#...............###.#.#...#.....#...#...#.#.......#...#...#...#...#.#.#.#.#...#...#...#.......#...###.....#...#.....#.....#.#...#...###...###
#.#############.###.#.###.#####.#.#######.#.#########.###.###.#.###.#.#.#.#######.###.#.#######.#####.#####.#.#.#########.#.###.#############
#.......#.....#...#.#.#...#.....#...###...#.........#...#...#...###.#.#...#...###.#...#.......#.#.....#.....#.#...#.......#.....#...#...#...#
#######.#.###.###.#.#.#.###.#######.###.###########.###.###.#######.#.#####.#.###.#.#########.#.#.#####.#####.###.#.#############.#.#.#.#.#.#
###...#...###...#...#.#...#.###...#.....#...#.....#...#...#.....#...#.....#.#.#...#.#.....###...#.......#...#.#...#...............#...#...#.#
###.#.#########.#####.###.#.###.#.#######.#.#.###.###.###.#####.#.#######.#.#.#.###.#.###.###############.#.#.#.###########################.#
#...#...........#...#.....#.....#.#.......#.#...#...#...#.#.....#.....#...#.#.#.....#.#...#...###.........#...#.#.........#...............#.#
#.###############.#.#############.#.#######.###.###.###.#.#.#########.#.###.#.#######.#.###.#.###.#############.#.#######.#.#############.#.#
#.........#.......#...#.....#.....#.#...###.....###.....#...#...#...#...###.#.###...#.#.....#...#.........#.....#.......#.#.............#...#
#########.#.#########.#.###.#.#####.#.#.#####################.#.#.#.#######.#.###.#.#.#########.#########.#.###########.#.#############.#####
#.........#.#...#.....#.###.#.....#...#.......#...#.....#.....#...#...###...#.....#.#.#...#...#...###.....#.#...........#...#...#...#...#...#
#.#########.#.#.#.#####.###.#####.###########.#.#.#.###.#.###########.###.#########.#.#.#.#.#.###.###.#####.#.#############.#.#.#.#.#.###.#.#
#...#...#...#.#...#...#...#.....#.#...#.......#.#.#.#...#.#.........#.#...#.........#.#.#...#...#.....#.....#.........#...#...#...#...###.#.#
###.#.#.#.###.#####.#.###.#####.#.#.#.#.#######.#.#.#.###.#.#######.#.#.###.#########.#.#######.#######.#############.#.#.###############.#.#
###...#...#...#...#.#.#...#.....#...#...#...#...#...#.....#.....###...#...#.......###...###...#.........#...#...#.....#.#.#...###.......#.#.#
###########.###.#.#.#.#.###.#############.#.#.#################.#########.#######.#########.#.###########.#.#.#.#.#####.#.#.#.###.#####.#.#.#
#...#...###.....#.#.#.#.###.#...#.........#...#.....#...........#...###...#.......#...#...#.#.#...###.....#...#...###...#...#.....#...#...#.#
#.#.#.#.#########.#.#.#.###.#.#.#.#############.###.#.###########.#.###.###.#######.#.#.#.#.#.#.#.###.###############.#############.#.#####.#
#.#...#.......###...#.#...#...#...#...#.........###...#...........#.#...#...#...#...#.#.#.#.#.#.#.....#...###...#...#.#...#.....#...#.#.....#
#.###########.#######.###.#########.#.#.###############.###########.#.###.###.#.#.###.#.#.#.#.#.#######.#.###.#.#.#.#.#.#.#.###.#.###.#.#####
#.#.........#.#...#...#...#.........#...###...........#...#.....#...#...#...#.#.#.#...#.#.#.#.#.........#.....#...#...#.#.#...#...#...#.....#
#.#.#######.#.#.#.#.###.###.###############.#########.###.#.###.#.#####.###.#.#.#.#.###.#.#.#.#########################.#.###.#####.#######.#
#...###...#.#...#.#.....###.#...#.........#.#.....#...#...#.###...#...#.#...#.#.#.#.....#...#...#...#.......#.....#...#.#.#...#...#.......#.#
#######.#.#.#####.#########.#.#.#.#######.#.#.###.#.###.###.#######.#.#.#.###.#.#.#############.#.#.#.#####.#.###.#.#.#.#.#.###.#.#######.#.#
#.......#.#.....#.#...#...#...#...#.....#...#...#...###...#...#...#.#.#.#.#...#.#.....#.......#.#.#.#.....#.#...#.#.#.#.#.#...#.#.#...###...#
#.#######.#####.#.#.#.#.#.#########.###.#######.#########.###.#.#.#.#.#.#.#.###.#####.#.#####.#.#.#.#####.#.###.#.#.#.#.#.###.#.#.#.#.#######
#.#.....#.......#...#.#.#.#...###...###.......#...###.....#...#.#...#.#.#...#...#...#.#.#.....#...#...#...#.....#...#...#.....#.#.#.#.......#
#.#.###.#############.#.#.#.#.###.###########.###.###.#####.###.#####.#.#####.###.#.#.#.#.###########.#.#######################.#.#.#######.#
#...###...#.....#...#...#.#.#...#...........#...#...#.....#...#.#...#...#.....#...#.#.#.#...#.......#.#...........#.......#...#.#.#.#.......#
#########.#.###.#.#.#####.#.###.###########.###.###.#####.###.#.#.#.#####.#####.###.#.#.###.#.#####.#.###########.#.#####.#.#.#.#.#.#.#######
#.........#.###...#.....#.#...#.............###.....#...#.#...#...#...#...#...#...#.#...###...#.....#.......#.....#.#.....#.#...#...#...#...#
#.#########.###########.#.###.#######################.#.#.#.#########.#.###.#.###.#.###########.###########.#.#####.#.#####.###########.#.#.#
#.......#...#...#...#...#.....#.............###...#...#.#.#...###...#.#.....#.#...#.....#...###...#...#...#...#...#.#...#...#.........#...#.#
#######.#.###.#.#.#.#.#########.###########.###.#.#.###.#.###.###.#.#.#######.#.#######.#.#.#####.#.#.#.#.#####.#.#.###.#.###.#######.#####.#
#...###...###.#...#...#...#...#.#...........#...#.#.#...#.#...#...#.#.#.......#.#.......#.#.#.....#.#.#.#.....#.#.#...#.#.#...#.....#.#.....#
#.#.#########.#########.#.#.#.#.#.###########.###.#.#.###.#.###.###.#.#.#######.#.#######.#.#.#####.#.#.#####.#.#.###.#.#.#.###.###.#.#.#####
#.#...........#.....#...#.#.#...#...........#.#...#.#.#...#...#...#...#...###...#.......#.#.#.......#...#...#...#.....#...#.....#...#...#...#
#.#############.###.#.###.#.###############.#.#.###.#.#.#####.###.#######.###.#########.#.#.#############.#.#####################.#######.#.#
#.#...#...#...#.#...#.#...#.#...............#.#.#...#.#.#...#...#.......#...#...#...#...#.#.#...#.........#.#...#...#...#...#...#...###...#.#
#.#.#.#.#.#.#.#.#.###.#.###.#.###############.#.#.###.#.#.#.###.#######.###.###.#.#.#.###.#.#.#.#.#########.#.#.#.#.#.#.#.#.#.#.###.###.###.#
#.#.#.#.#...#...#.#...#...#.#...#.....#.......#.#...#.#.#.#.....#.......#...#...#.#...#...#...#.#.....#...#...#.#.#.#.#.#.#.#.#...#.....#...#
#.#.#.#.#########.#.#####.#.###.#.###.#.#######.###.#.#.#.#######.#######.###.###.#####.#######.#####.#.#.#####.#.#.#.#.#.#.#.###.#######.###
#.#.#.#.#.....#...#.#...#...#...#.#...#.#.......#...#...#...#...#.......#.###...#...###.#.......#...#...#.....#.#.#...#...#...#...#...#...###
#.#.#.#.#.###.#.###.#.#.#####.###.#.###.#.#######.#########.#.#.#######.#.#####.###.###.#.#######.#.#########.#.#.#############.###.#.#.#####
#...#...#...#.#.....#.#.....#.....#...#.#.....###...#.......#.#.#...#...#...###...#...#.#.#.....#.#.#...#...#.#.#.......###...#...#.#.#.....#
###########.#.#######.#####.#########.#.#####.#####.#.#######.#.#.#.#.#####.#####.###.#.#.#.###.#.#.#.#.#.#.#.#.#######.###.#.###.#.#.#####.#
###...#...#.#.#...###.....#.#...#.....#.#.....#...#.#.###...#.#.#.#.#.#.....#...#...#.#.#.#.#...#.#.#.#.#.#...#...#...#.....#...#...#.#.....#
###.#.#.#.#.#.#.#.#######.#.#.#.#.#####.#.#####.#.#.#.###.#.#.#.#.#.#.#.#####.#.###.#.#.#.#.#.###.#.#.#.#.#######.#.#.#########.#####.#.#####
#...#...#...#.#.#.......#.#...#...#...#.#...#...#.#.#.#...#.#.#.#.#.#.#...#...#.#...#.#.#...#...#.#...#.#...#...#...#...#.....#...###.#.....#
#.###########.#.#######.#.#########.#.#.###.#.###.#.#.#.###.#.#.#.#.#.###.#.###.#.###.#.#######.#.#####.###.#.#.#######.#.###.###.###.#####.#
#.....#.....#...#.....#...#.......#.#.#.#...#...#.#.#.#.#...#.#.#.#...#...#...#.#...#.#.#.......#...###...#...#.....###...###.#...#...#...#.#
#####.#.###.#####.###.#####.#####.#.#.#.#.#####.#.#.#.#.#.###.#.#.#####.#####.#.###.#.#.#.#########.#####.#########.#########.#.###.###.#.#.#
#.....#.###.....#...#.....#...#...#.#...#...#...#...#.#.#.#...#.#.....#...#...#.#...#.#.#...#.....#.....#.#.......#.......#...#...#...#.#...#
#.#####.#######.###.#####.###.#.###.#######.#.#######.#.#.#.###.#####.###.#.###.#.###.#.###.#.###.#####.#.#.#####.#######.#.#####.###.#.#####
#.#...#.#.......#...#...#...#.#...#.....#...#.#.......#.#.#.#...#.....#...#.###.#...#.#.#...#.###.#.....#...#...#.........#.#.....#...#.....#
#.#.#.#.#.#######.###.#.###.#.###.#####.#.###.#.#######.#.#.#.###.#####.###.###.###.#.#.#.###.###.#.#########.#.###########.#.#####.#######.#
#.#.#...#.......#.....#.###...###.#...#.#.#...#.....#...#.#.#...#.....#...#...#.....#.#.#...#.#...#...........#.........###...#.....#...#...#
#.#.###########.#######.#########.#.#.#.#.#.#######.#.###.#.###.#####.###.###.#######.#.###.#.#.#######################.#######.#####.#.#.###
#.#...###...###.#.......#.........#.#...#.#.#.......#.#...#.#...#...#...#...#.....###...###...#...#...#...#...#.........#...###.......#...###
#.###.###.#.###.#.#######.#########.#####.#.#.#######.#.###.#.###.#.###.###.#####.###############.#.#.#.#.#.#.#.#########.#.#################
#.#...#...#.....#...#.....#...#...#.....#.#.#.#...#...#...#.#...#.#.....###.#...#.......###.......#.#.#.#...#.#...........#.....#...........#
#.#.###.###########.#.#####.#.#.#.#####.#.#.#.#.#.#.#####.#.###.#.#########.#.#.#######.###.#######.#.#.#####.#################.#.#########.#
#...###.........#...#.#...#.#...#...#...#.#.#.#.#.#...###.#.#...#.......#...#.#.#.......#...#...#...#.#.###...#...........#.....#.....#...#.#
###############.#.###.#.#.#.#######.#.###.#.#.#.#.###.###.#.#.#########.#.###.#.#.#######.###.#.#.###.#.###.###.#########.#.#########.#.#.#.#
#...............#.###...#.#.#.......#.###.#.#.#.#.#...#...#.#...#...#...#.#...#.#.#.....#...#.#.#...#.#...#...#.........#...#...###...#.#.#.#
#.###############.#######.#.#.#######.###.#.#.#.#.#.###.###.###.#.#.#.###.#.###.#.#.###.###.#.#.###.#.###.###.#########.#####.#.###.###.#.#.#
#.#...#.......#...#.......#.#...#...#...#.#.#.#.#.#.#...#...#...#.#.#.###.#.###.#...#...###.#.#...#.#...#...#...#.....#.......#.....#...#...#
#.#.#.#.#####.#.###.#######.###.#.#.###.#.#.#.#.#.#.#.###.###.###.#.#.###.#.###.#####.#####.#.###.#.###.###.###.#.###.###############.#######
#...#.#.#.....#...#...#...#...#.#.#...#.#...#.#.#.#.#.#...###...#.#.#...#.#.#...#...#.....#...#...#...#...#...#.#...#.....#.....#...#.......#
#####.#.#.#######.###.#.#.###.#.#.###.#.#####.#.#.#.#.#.#######.#.#.###.#.#.#.###.#.#####.#####.#####.###.###.#.###.#####.#.###.#.#.#######.#
#.....#.#.#.....#.###...#.#...#.#...#.#...###...#.#.#...#.......#.#.#...#...#.#...#.#.....#...#...#...###...#.#...#.....#.#...#.#.#...#...#.#
#.#####.#.#.###.#.#######.#.###.###.#.###.#######.#.#####.#######.#.#.#######.#.###.#.#####.#.###.#.#######.#.###.#####.#.###.#.#.###.#.#.#.#
#.#...#.#.#...#.#.#.....#.#.#...#...#...#.....###.#...###...#...#.#.#.#...###.#...#.#.......#...#...#.......#.###...#...#.....#.#.###...#.#.#
#.#.#.#.#.###.#.#.#.###.#.#.#.###.#####.#####.###.###.#####.#.#.#.#.#.#.#.###.###.#.###########.#####.#######.#####.#.#########.#.#######.#.#
#...#...#...#.#.#.#...#...#.#...#...#...#...#...#.....#...#.#.#...#.#...#...#...#.#...#...#...#.....#.......#.#...#.#.........#.#.......#.#.#
###########.#.#.#.###.#####.###.###.#.###.#.###.#######.#.#.#.#####.#######.###.#.###.#.#.#.#.#####.#######.#.#.#.#.#########.#.#######.#.#.#
#...........#.#.#...#.....#...#...#.#.....#.#...#.......#...#.###...#...#...###.#.###...#.#.#.......#...###...#.#...#...#.....#.........#.#.#
#.###########.#.###.#####.###.###.#.#######.#.###.###########.###.###.#.#.#####.#.#######.#.#########.#.#######.#####.#.#.###############.#.#
#...#...#...#.#.....#.....#...#...#.......#.#.###...#...#...#.#...#...#.#.#...#.#...#.....#.....###...#.........#...#.#.#.#...#...#...###...#
###.#.#.#.#.#.#######.#####.###.#########.#.#.#####.#.#.#.#.#.#.###.###.#.#.#.#.###.#.#########.###.#############.#.#.#.#.#.#.#.#.#.#.#######
#...#.#.#.#.#.#.......#...#...#...#...#...#.#.....#.#.#.#.#.#.#...#.#...#...#.#.#...#.#...#...#...#.#...#...#...#.#.#.#.#...#...#...#.......#
#.###.#.#.#.#.#.#######.#.###.###.#.#.#.###.#####.#.#.#.#.#.#.###.#.#.#######.#.#.###.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.###################.#
#.....#...#...#.........#.....###...#...###.......#...#...#...###...#.........#...###...#...#.....#...#...#...#...#...#.....................#
#############################################################################################################################################</textarea><br><br>

			<!-- The 'run simulation' button and result fields -->
			<div style="display: inline-block;  border: 1px solid #00cc00; padding: 10px; margin-left: 10px;">
				<input type="button" onclick="solveThatShit();" value="[ Run Simulation ]"  style="background: transparent; border: 0; font-family: inherit; font-size: 26px; margin: 0; padding: 0; color: #009900; cursor: pointer;"><br>

				<p style="color: #00cc00;">
				    Part 1 Result: <input type = "text"  id = "part1" value = "" size=46/><input type="button" onclick="document.getElementById('part1').select();document.execCommand('copy');window.getSelection().removeAllRanges();" value="[ Copy ]"  style="background: transparent; border: 0; font-family: inherit; font-size: 16px; margin: 0; padding: 0; color: #009900; cursor: pointer;"><br>
				    Part 2 Result: <input type = "text"  id = "part2" value = "" size=46/><input type="button" onclick="document.getElementById('part2').select();document.execCommand('copy');window.getSelection().removeAllRanges();" value="[ Copy ]"  style="background: transparent; border: 0; font-family: inherit; font-size: 16px; margin: 0; padding: 0; color: #009900; cursor: pointer;"><br>
				</p>
			</div>

			<!-- Debug Output Box -->
			<br><br>

		    <font style="color: #00cc00;">Debug Output:</font><br>

		    <textarea id="debug" name="Text1" cols="80" rows="15" style="font-size: 16px; border:solid 1px #00cc00;"></textarea>
		</div>
	</body>
</html>